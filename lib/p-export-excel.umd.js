/*!
* p-export-excel v1.1.0
* Copyright 2024 Pbstar (https://github.com/pbstar)
* Licensed under MIT (https://github.com/pbstar/p-export-excel/blob/main/LICENSE)
* 2024-07-31 11:05:59
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).pExportExcel=t()}(this,(function(){"use strict";function e(e,t){if("base64"==e.resType)return t;if("blob"==e.resType)return o=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if("file"==e.resType)return new File([t],e.fileName+"."+e.fileType,{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if("download"==e.resType){var r=document.createElement("a");return r.href=t,r.download=e.fileName+"."+e.fileType,r.click(),"success"}if("bloburl"==e.resType){var o=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return URL.createObjectURL(o)}}function t(e,t){return new Promise((function(r,o){var l="";if("xlsx"==e.fileType){var n=t.xlsx;l='\n        <div style="width: 100%;height: 470px;overflow: auto;">\n          '.concat(n.map((function(e,t){return'<div class="pee_tab_content" style="display: '.concat(0===t?"block":"none",';">').concat(e,"</div>")})).join(""),'\n        </div>\n        <div style="width: 100%;height: 25px;display: flex;align-items: center;margin-top: 4px;box-sizing: border-box;border-left: 1px solid #ccc;border-bottom: 1px solid #ccc;">\n          ').concat(e.sheets.map((function(e,t){return'<div class="pee_tab_bar" style="width:100px;height:25px;font-size:12px;cursor: pointer;border: 1px solid #ccc;border-bottom-color: '.concat(0===t?"#1890ff":"transparent",';border-left:0;box-sizing: border-box;display:flex;justify-content: center;align-items: center;">').concat(e.sheetName,"</div>")})).join(""),"\n        </div>\n      ")}else"csv"==e.fileType&&(l=t.csv).indexOf("\n")>=0&&(l=l.replace("\n","<br/>"));var i=document.querySelector("body"),s=document.createElement("div");s.style.width="100%",s.style.height="100%",s.style.position="fixed",s.style.top="0",s.style.left="0",s.style.backgroundColor="rgba(0,0,0,0.5)",s.style.zIndex="9999",s.style.display="flex",s.style.justifyContent="center",s.style.alignItems="center",s.innerHTML='\n    <div style="width: 800px;height: 600px;background-color: white;border-radius: 3px;overflow: hidden;display: flex;flex-direction: column;align-items: center;justify-content: space-between;">\n      <div style="width: 100%;height: 50px;padding:0 15px;display: flex;justify-content: space-between;align-items: center;box-sizing: border-box;">\n        <div style="font-size: 18px;">预览</div>\n        <div id="pee_close" style="cursor: pointer;">X</div>\n      </div>\n      <div style="width: 100%;height: 500px;overflow: auto;box-sizing: border-box;padding: 0 10px;">\n        '.concat(l,'\n      </div>\n      <div style="width: 100%;height: 50px;display: flex;justify-content: center;align-items: center;">\n        <button style="width: 100px;height: 30px;lin-height:28px;border: 1px solid #eee;background-color: #fff;color: #333;border-radius: 5px;cursor: pointer;" id="pee_close">取消</button>\n        <button style="width: 100px;height: 30px;lin-height:30px;border: none;background-color: #1890ff;color: white;border-radius: 5px;cursor: pointer;margin-left: 15px;" id="pee_ok">确定</button>\n      </div>\n    </div>\n    '),null==i||i.appendChild(s);var c=document.querySelector("#pee_close");null==c||c.addEventListener("click",(function(){a(!1)}));var f=document.querySelector("#pee_ok");function a(e){null==i||i.removeChild(s),r(e)}null==f||f.addEventListener("click",(function(){a(!0)}));var d=document.querySelectorAll(".pee_tab_bar");d&&d.forEach((function(e,t){e.addEventListener("click",(function(){var e;e=t,document.querySelectorAll(".pee_tab_content").forEach((function(t,r){t.style.display=r===e?"block":"none"})),document.querySelectorAll(".pee_tab_bar").forEach((function(t,r){t.style.borderBottomColor=r===e?"#1890ff":"#fff"}))}))}))}))}return function(r){return new Promise((function(o,l){var n=function(e){var t={fileName:"文件",fileType:"xlsx",sheets:[],sheetStyle:"",rowStyle:"",cellStyle:"",resType:"download",isPreview:!1};if(!e)return console.error("请传入配置参数"),!1;if(e.fileName){if("string"!=typeof e.fileName)return console.error("fileName参数类型错误，请传入字符串"),!1;if(e.fileName.length>50)return console.error("fileName参数长度不能超过50"),!1;if(!/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(e.fileName))return console.error("fileName参数不合法，请传入合法的文件名"),!1;t.fileName=e.fileName}if(e.fileType){if("string"!=typeof e.fileType)return console.error("fileType参数类型错误，请传入字符串"),!1;if(!["xlsx","csv"].includes(e.fileType))return console.error("fileType参数不合法，请传入xlsx或csv"),!1;t.fileType=e.fileType}if(e.sheets){if(!Array.isArray(e.sheets))return console.error("sheets参数类型错误，请传入数组"),!1;t.sheets=e.sheets}if(e.sheetStyle){if("string"!=typeof e.sheetStyle)return console.error("sheetStyle参数类型错误，请传入字符串"),!1;t.sheetStyle=e.sheetStyle}if(e.rowStyle){if("string"!=typeof e.rowStyle)return console.error("rowStyle参数类型错误，请传入字符串"),!1;t.rowStyle=e.rowStyle}if(e.cellStyle){if("string"!=typeof e.cellStyle)return console.error("cellStyle参数类型错误，请传入字符串"),!1;t.cellStyle=e.cellStyle}if(e.resType){if("string"!=typeof e.resType)return console.error("resType参数类型错误，请传入字符串"),!1;if(!["download","blob","bloburl","file","base64"].includes(e.resType))return console.error("resType参数不合法，请传入download、blob、bloburl、file或base64"),!1;t.resType=e.resType}if(e.isPreview||!1===e.isPreview){if("boolean"!=typeof e.isPreview)return console.error("isPreview参数类型错误，请传入布尔值"),!1;t.isPreview=e.isPreview}return t}(r);if("boolean"==typeof n)return l("error:config error");var i=n,s=function(e){var t="",r="",o=[],l="";if("xlsx"==e.fileType){r+="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>",r+='<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">',r+="<head>",r+="\x3c!--[if gte mso 9]>",r+="<xml>",r+="<x:ExcelWorkbook>",r+="<x:ExcelWorksheets>";for(var n=0;n<e.sheets.length;n++)r+="<x:ExcelWorksheet>",r+="<x:Name>",r+=(i=e.sheets[n]).sheetName||"sheet"+(n+1),r+="</x:Name>",r+="<x:WorksheetOptions>",r+="<x:DisplayGridlines/>",r+="</x:WorksheetOptions>",r+="</x:ExcelWorksheet>";for(r+="</x:ExcelWorksheets>",r+="</x:ExcelWorkbook>",r+="</xml>",r+="<![endif]--\x3e",r+="</head>",r+="<body>",n=0;n<e.sheets.length;n++){var i=e.sheets[n],s="";e.sheetStyle&&(s+=e.sheetStyle),i.style&&(s+=i.style);for(var c="<table style='border-spacing: 0;font-family:宋体;"+s+";vnd.ms-excel.numberformat:@'>",f=0;f<i.rows.length;f++){var a=i.rows[f],d="";e.rowStyle&&(d+=e.rowStyle),i.rowStyle&&(d+=i.rowStyle),a.style&&(d+=a.style),c+="<tr style='"+d+"'>";for(var p=0;p<a.cells.length;p++){var y=a.cells[p],u="";e.cellStyle&&(u+=e.cellStyle),i.cellStyle&&(u+=i.cellStyle),a.cellStyle&&(u+=a.cellStyle),y instanceof Object?(c+="<td",y.colspan&&(c+=" colspan="+y.colspan),y.rowspan&&(c+=" rowspan="+y.rowspan),y.style&&(u+=y.style),c+=" style='"+u+"'>"+y.text+"</td>"):c+="<td style='"+u+"'>"+y+"</td>"}c+="</tr>"}r+=c+="</table>",o.push(c)}r+="</body>",r+="</html>",t="data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(r)}else if("csv"==e.fileType){if(e.sheets.length>0)for(e.sheets.length>1&&console.warn("csv格式下多表导出仅会导出第一个表"),i=e.sheets[0],f=0;f<i.rows.length;f++)for(a=i.rows[f],f>0&&(l+=" \n "),p=0;p<a.cells.length;p++)p>0&&(l+=","),l+=(y=a.cells[p])instanceof Object?y.text:y;t="data:text/csv;charset=utf-8,"+encodeURIComponent(l)}return{base64:t,csv:l,xlsx:o}}(i);if(!s.base64)return l("error: create file error");if(i.isPreview)t(i,s).then((function(t){if(t){var r=e(i,s.base64);o(r)}else l("error: preview error")}));else{var c=e(i,s.base64);o(c)}}))}}));
