/*!
* p-export-excel v1.1.0
* Copyright 2024 Pbstar (https://github.com/pbstar)
* Licensed under MIT (https://github.com/pbstar/p-export-excel/blob/main/LICENSE)
* 2024-07-30 10:30:42
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).pExportExcel=t()}(this,(function(){"use strict";return function(e){return new Promise((function(t,r){var l=function(e){var t={fileName:"文件",fileType:"xlsx",sheets:[],sheetStyle:"",rowStyle:"",cellStyle:"",resType:"download"};if(!e)return console.error("请传入配置参数"),!1;if(e.fileName){if("string"!=typeof e.fileName)return console.error("fileName参数类型错误，请传入字符串"),!1;if(e.fileName.length>50)return console.error("fileName参数长度不能超过50"),!1;if(!/^[a-zA-Z0-9\u4e00-\u9fa5_-]+$/.test(e.fileName))return console.error("fileName参数不合法，请传入合法的文件名"),!1;t.fileName=e.fileName}if(e.fileType){if("string"!=typeof e.fileType)return console.error("fileType参数类型错误，请传入字符串"),!1;if(!["xlsx","csv"].includes(e.fileType))return console.error("fileType参数不合法，请传入xlsx或csv"),!1;t.fileType=e.fileType}if(e.sheets){if(!Array.isArray(e.sheets))return console.error("sheets参数类型错误，请传入数组"),!1;t.sheets=e.sheets}if(e.sheetStyle){if("string"!=typeof e.sheetStyle)return console.error("sheetStyle参数类型错误，请传入字符串"),!1;t.sheetStyle=e.sheetStyle}if(e.rowStyle){if("string"!=typeof e.rowStyle)return console.error("rowStyle参数类型错误，请传入字符串"),!1;t.rowStyle=e.rowStyle}if(e.cellStyle){if("string"!=typeof e.cellStyle)return console.error("cellStyle参数类型错误，请传入字符串"),!1;t.cellStyle=e.cellStyle}if(e.resType){if("string"!=typeof e.resType)return console.error("resType参数类型错误，请传入字符串"),!1;if(!["download","blob","bloburl","file","base64"].includes(e.resType))return console.error("resType参数不合法，请传入download、blob、bloburl、file或base64"),!1;t.resType=e.resType}return t}(e);if("boolean"==typeof l)return r("error:config error");var o=l,s="xlsx"==o.fileType?function(e){var t="<html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:x='urn:schemas-microsoft-com:office:excel' xmlns='http://www.w3.org/TR/REC-html40'>";t+='<meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">',t+="<head>",t+="\x3c!--[if gte mso 9]>",t+="<xml>",t+="<x:ExcelWorkbook>",t+="<x:ExcelWorksheets>";for(var r=0;r<e.sheets.length;r++)t+="<x:ExcelWorksheet>",t+="<x:Name>",t+=(l=e.sheets[r]).sheetName||"sheet"+(r+1),t+="</x:Name>",t+="<x:WorksheetOptions>",t+="<x:DisplayGridlines/>",t+="</x:WorksheetOptions>",t+="</x:ExcelWorksheet>";for(t+="</x:ExcelWorksheets>",t+="</x:ExcelWorkbook>",t+="</xml>",t+="<![endif]--\x3e",t+="</head>",t+="<body>",r=0;r<e.sheets.length;r++){var l=e.sheets[r],o="";e.sheetStyle&&(o+=e.sheetStyle),l.style&&(o+=l.style),t+="<table style='font-family:宋体;"+o+";vnd.ms-excel.numberformat:@'>";for(var s=0;s<l.rows.length;s++){var n=l.rows[s],f="";e.rowStyle&&(f+=e.rowStyle),l.rowStyle&&(f+=l.rowStyle),n.style&&(f+=n.style),t+="<tr style='"+f+"'>";for(var i=0;i<n.cells.length;i++){var c=n.cells[i],a="";e.cellStyle&&(a+=e.cellStyle),l.cellStyle&&(a+=l.cellStyle),n.cellStyle&&(a+=n.cellStyle),c instanceof Object?(t+="<td",c.colspan&&(t+=" colspan="+c.colspan),c.rowspan&&(t+=" rowspan="+c.rowspan),c.style&&(a+=c.style),t+=" style='"+a+"'>"+c.text+"</td>"):t+="<td style='"+a+"'>"+c+"</td>"}t+="</tr>"}t+="</table>"}return t+="</body>",t+="</html>","data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(t)}(o):function(e){var t="";if(e.sheets.length>0){e.sheets.length>1&&console.warn("csv格式下多表导出仅会导出第一个表");for(var r=e.sheets[0],l=0;l<r.rows.length;l++){var o=r.rows[l];l>0&&(t+="\n");for(var s=0;s<o.cells.length;s++){var n=o.cells[s];s>0&&(t+=","),t+=n instanceof Object?n.text:n}}}return"data:text/csv;charset=utf-8,"+encodeURIComponent(t)}(o);if(!s)return r("error: create file error");var n=function(e,t){if("base64"==e.resType)return t;if("blob"==e.resType)return new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if("file"==e.resType)return new File([t],e.fileName+"."+e.fileType,{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});if("download"==e.resType){var r=document.createElement("a");return r.href=t,r.download=e.fileName+"."+e.fileType,r.click(),"success"}if("bloburl"==e.resType){var l=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return URL.createObjectURL(l)}}(o,s);t(n)}))}}));
