<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <button id="btn1">导出简约表</button>
  <button id="btn2">导出复杂表</button>
  <script src="../lib/p-export-excel.umd.js"></script>
  <script>
    // 简约数据表
    const data1 = {
      fileName: "简约数据表",
      sheets: [
        {
          rows: [
            {
              cells: ["Cell 1", "Cell 2", "Cell 3"],
            }, {
              cells: ["Cell 4", "Cell 5", "Cell 5"],
            },
          ],
        },
      ]
    };
    let btn1 = document.getElementById('btn1')
    btn1.onclick = function () {
      pExportExcel(data1)
    }
    // 复杂数据表
    const data2 = {
      fileName: "复杂数据表",
      rowStyle: "height: 40px;vertical-align: middle;",
      cellStyle: "border: 1px solid #eee;width: 100px;text-align: center;",
      sheets: [{
        sheetName: "学生名单",
        style: "font-size: 16px;font-family: 微软雅黑;",
        rows: [
          {
            style: "font-weight: bold;color: #fff;font-size: 18px;",
            cellStyle: "background-color: #29B8DB;border: 1px solid #fff;",
            cells: [
              {
                text: "三年级（1）班全体学生名单",
                colspan: 5,
              }
            ]
          },
          {
            style: "font-weight: bold;color: #fff;",
            cellStyle: "background-color: #29B8DB;border: 1px solid #fff;",
            cells: ["序号", "姓名", "性别", "年龄", {
              text: "备注", style: "width: 200px;"
            }]
          },
          {
            cells: ["1", "张三", "男", 12, ""]
          },
          {
            cellStyle: "background-color: #F5F5F5;",
            cells: ["2", "李四", "女", 11, ""]
          },
          {
            cells: ["3", "王五", "男", 12, "校长侄子"]
          },
          {
            cellStyle: "background-color: #F5F5F5;",
            cells: ["4", "赵六", "女", 11, ""]
          }
        ]
      }]
    }
    let btn2 = document.getElementById('btn2')
    btn2.onclick = function () {
      pExportExcel(data2).then(e => {
        console.log(e)
      }).catch(err => {
        console.log(err)
      })
    }
  </script>
</body>

</html>